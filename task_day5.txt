REPORT ZRH_TASK5.

TYPES:BEGIN OF ty_produktet,

ID TYPE I ,

Emri_i_produktit TYPE C LENGTH 10,

DATA_PRODHIMIT TYPE D ,

Kosto Type P LENGTH 8 DECIMALS 3,

SASI TYPE I ,

GRUP TYPE C LENGTH 10,

DATA_SKADENCES TYPE D ,

KOSTO_TOTALE TYPE P LENGTH 16 DECIMALS 3,



END OF ty_produktet.


DATA: GS_PRODUKTET  TYPE TY_PRODUKTET,
GT_PRODUKTET TYPE STANDARD TABLE OF TY_PRODUKTET,

GV_tdate type d,

GV_humbje type p LENGTH 16 DECIMALS 3,
GV_stalk type p LENGTH 16 DECIMALS 3,
GV_kostototalepro  type p LENGTH 16 DECIMALS 6.



GS_PRODUKTET-ID = 1.
GS_PRODUKTET-Emri_i_produktit = 'Deka'.
GS_PRODUKTET-DATA_PRODHIMIT = '20221212'.
GS_PRODUKTET-Kosto = '52.3'.
GS_PRODUKTET-SASI = 200.
GS_PRODUKTET-GRUP = 'ILAC'.
GS_PRODUKTET-KOSTO_TOTALE = GS_PRODUKTET-Kosto * GS_PRODUKTET-SASI .
APPEND GS_PRODUKTET TO GT_PRODUKTET.
CLEAR GS_PRODUKTET.

GS_PRODUKTET-ID = 2.
GS_PRODUKTET-Emri_i_produktit = 'Sheqer'.
GS_PRODUKTET-DATA_PRODHIMIT = '20220504'.
GS_PRODUKTET-Kosto = '30'.
GS_PRODUKTET-SASI = 63.
GS_PRODUKTET-GRUP = 'USHQIM'.
GS_PRODUKTET-KOSTO_TOTALE = GS_PRODUKTET-Kosto * GS_PRODUKTET-SASI .
APPEND GS_PRODUKTET TO GT_PRODUKTET.
CLEAR GS_PRODUKTET.

GS_PRODUKTET-ID = 3.
GS_PRODUKTET-Emri_i_produktit = 'Mjell'.
GS_PRODUKTET-DATA_PRODHIMIT = '20220605'.
GS_PRODUKTET-Kosto = '50'.
GS_PRODUKTET-SASI = 25.
GS_PRODUKTET-GRUP = 'USHQIM'.
GS_PRODUKTET-KOSTO_TOTALE = GS_PRODUKTET-Kosto * GS_PRODUKTET-SASI .
APPEND GS_PRODUKTET TO GT_PRODUKTET.
CLEAR GS_PRODUKTET.

GS_PRODUKTET-ID = 4.
GS_PRODUKTET-Emri_i_produktit = 'Kripe'.
GS_PRODUKTET-DATA_PRODHIMIT = '20220203'.
GS_PRODUKTET-Kosto = '20'.
GS_PRODUKTET-SASI = 56.
GS_PRODUKTET-GRUP = 'USHQIM'.
GS_PRODUKTET-KOSTO_TOTALE = GS_PRODUKTET-Kosto * GS_PRODUKTET-SASI .
APPEND GS_PRODUKTET TO GT_PRODUKTET.
CLEAR GS_PRODUKTET.

GS_PRODUKTET-ID = 5.
GS_PRODUKTET-Emri_i_produktit = 'Vaj'.
GS_PRODUKTET-DATA_PRODHIMIT = '20211212'.
GS_PRODUKTET-Kosto = '65'.
GS_PRODUKTET-SASI = 42.
GS_PRODUKTET-GRUP = 'USHQIM'.
GS_PRODUKTET-KOSTO_TOTALE = GS_PRODUKTET-Kosto * GS_PRODUKTET-SASI .
APPEND GS_PRODUKTET TO GT_PRODUKTET.
CLEAR GS_PRODUKTET.

GS_PRODUKTET-ID = 6.
GS_PRODUKTET-Emri_i_produktit = 'Arome Rrobash'.
GS_PRODUKTET-DATA_PRODHIMIT = '20221312'.
GS_PRODUKTET-Kosto = '10.4'.
GS_PRODUKTET-SASI = 32.
GS_PRODUKTET-GRUP = 'ILAC'.
GS_PRODUKTET-KOSTO_TOTALE = GS_PRODUKTET-Kosto * GS_PRODUKTET-SASI .
APPEND GS_PRODUKTET TO GT_PRODUKTET.
CLEAR GS_PRODUKTET.

GS_PRODUKTET-ID = 7.
GS_PRODUKTET-Emri_i_produktit = 'Telefon'.
GS_PRODUKTET-DATA_PRODHIMIT = '20160504'.
GS_PRODUKTET-Kosto = '45.2'.
GS_PRODUKTET-SASI = 25.
GS_PRODUKTET-GRUP = 'AKSESOR'.
GS_PRODUKTET-KOSTO_TOTALE = GS_PRODUKTET-Kosto * GS_PRODUKTET-SASI .
APPEND GS_PRODUKTET TO GT_PRODUKTET.
CLEAR GS_PRODUKTET.

GS_PRODUKTET-ID = 8.
GS_PRODUKTET-Emri_i_produktit = 'Laptop'.
GS_PRODUKTET-DATA_PRODHIMIT = '20220505'.
GS_PRODUKTET-Kosto = 100.
GS_PRODUKTET-SASI = 300.
GS_PRODUKTET-GRUP = 'AKSESOR'.
GS_PRODUKTET-KOSTO_TOTALE = GS_PRODUKTET-Kosto * GS_PRODUKTET-SASI .
APPEND GS_PRODUKTET TO GT_PRODUKTET.
CLEAR GS_PRODUKTET.

GV_tdate = sy-datum.



LOOP AT GT_PRODUKTET INTO GS_PRODUKTET.

IF GS_PRODUKTET-GRUP = 'USHQIM'.
GS_PRODUKTET-DATA_SKADENCES = GS_PRODUKTET-DATA_PRODHIMIT + 60.
Modify gt_produktet from gs_produktet.
CLEAR GS_PRODUKTET.
ENDIF.


IF GS_PRODUKTET-GRUP = 'AKSESOR'.
GS_PRODUKTET-DATA_SKADENCES = GS_PRODUKTET-DATA_PRODHIMIT + 1827.
Modify gt_produktet from gs_produktet.
CLEAR GS_PRODUKTET.
ENDIF.

IF GS_PRODUKTET-GRUP = 'ILAC'.
GS_PRODUKTET-DATA_SKADENCES = GS_PRODUKTET-DATA_PRODHIMIT + 300.
Modify gt_produktet from gs_produktet.
CLEAR GS_PRODUKTET.
ENDIF.

ENDLOOP.

LOOP AT GT_PRODUKTET INTO GS_PRODUKTET.
  WRITE:/
GS_PRODUKTET-ID ,
GS_PRODUKTET-Emri_i_produktit ,
GS_PRODUKTET-DATA_PRODHIMIT ,
GS_PRODUKTET-Kosto ,
GS_PRODUKTET-SASI,
GS_PRODUKTET-GRUP,
GS_PRODUKTET-DATA_SKADENCES,
GS_PRODUKTET-KOSTO_TOTALE.

ENDLOOP.

uline.

LOOP AT GT_PRODUKTET INTO GS_PRODUKTET.

IF GS_PRODUKTET-DATA_SKADENCES > GV_tdate.
Write: / GS_PRODUKTET-Emri_i_produktit, ' Ky produkt eshte humbje. '.

ENDIF.

ENDLOOP.

uline.

LOOP AT GT_PRODUKTET INTO GS_PRODUKTET.

IF GS_PRODUKTET-DATA_SKADENCES > GV_tdate.
GV_humbje = GS_PRODUKTET-KOSTO_TOTALE + GV_humbje.
ENDIF.

IF GS_PRODUKTET-DATA_SKADENCES < GV_tdate.
GV_stalk = GS_PRODUKTET-KOSTO_TOTALE + GV_stalk.
ENDIF.

ENDLOOP.

GV_kostototalepro = GV_stalk + GV_humbje.

uline.

IF sy-subrc = 0.
Write: / GV_humbje, ' eshte humbja totale' .
Write: / GV_stalk, ' eshte stalk total ' .
Write: / GV_kostototalepro , ' eshte kostoja totale e te gjithave produketve'.

ENDIF.